# 画像モザイク加工ツール

iPhoneのSafariで動作するHTML/CSS/JavaScript製の画像モザイク加工ツールです。App Storeからのダウンロード不要で、ブラウザ上で直接動作します。

## 🚀 特徴

- **App Store不要**: ブラウザで直接動作
- **完全オフライン**: 画像処理は全てクライアントサイドで実行
- **PWA対応**: ホーム画面に追加可能
- **タッチ最適化**: iPhone向けのタッチ操作に最適化
- **高性能**: Canvas APIを使用した高速モザイク処理

## 📱 対応環境

### 推奨環境
- iOS 14.0以上
- Safari 14.0以上
- iPhone 8以降

### 最低動作環境
- iOS 12.0以上
- Safari 12.0以上
- iPhone 7以降

## 🎯 機能

### 基本機能
- ✅ 画像選択（JPEG, PNG, WebP対応）
- ✅ タッチでモザイク描画
- ✅ モザイク粒度調整（1px-100px）
- ✅ ブラシサイズ調整
- ✅ 消しゴム機能
- ✅ Undo/Redo機能（最大20回）
- ✅ ピンチイン・アウト対応
- ✅ 画像保存（元ファイル名_mosa.png）

### UI/UX
- ✅ レスポンシブデザイン
- ✅ ダークモード対応
- ✅ iPhone X以降のセーフエリア対応
- ✅ タッチフィードバック
- ✅ ローディング表示
- ✅ トースト通知

## 🛠 技術仕様

### フロントエンド
- **HTML5**: セマンティックマークアップ
- **CSS3**: Flexbox, Grid, カスタムプロパティ
- **JavaScript ES6+**: モジュール、クラス、非同期処理

### Canvas API
- **2D Context**: 画像描画・操作
- **ImageData**: ピクセル単位の画像処理
- **モザイクアルゴリズム**: ブロック平均化方式

### PWA機能
- **Service Worker**: オフライン対応・キャッシュ
- **Web App Manifest**: ホーム画面追加
- **Apple Touch Icon**: iOS最適化

## 📂 ファイル構成

```
mosaic-tool/
├── index.html          # メインHTML
├── style.css           # スタイルシート
├── script.js           # メインJavaScript
├── manifest.json       # PWAマニフェスト
├── service-worker.js   # Service Worker
├── requirements.md     # 要件定義書
└── README.md          # このファイル
```

## 🚀 使用方法

### 1. 基本的な使い方

1. **画像選択**: 「📷 画像を選択」ボタンをタップ
2. **モザイク描画**: 画面をなぞってモザイクを適用
3. **設定調整**: 粒度・ブラシサイズを調整
4. **保存**: 「✅ 完了」ボタンで画像を保存

### 2. 詳細機能

#### モザイク描画
- 指でなぞった部分にモザイクが適用されます
- 粒度（1px-100px）でモザイクの細かさを調整可能

#### 消しゴム機能
- 「🧽 消しゴム」モードでモザイクを除去
- 元画像の状態に戻すことができます

#### Undo/Redo
- 「↶」「↷」ボタンまたはCtrl+Z/Ctrl+Yで操作を取り消し・復元
- 最大20回まで履歴を保持

#### ピンチ操作
- 二本指でピンチイン・アウトして画像を拡大・縮小
- パン操作で画像の表示位置を調整

### 3. PWAとしてインストール

1. SafariでWebサイトを開く
2. 共有ボタン（□↑）をタップ
3. 「ホーム画面に追加」を選択
4. ホーム画面にアプリアイコンが追加されます

## 🔧 開発・カスタマイズ

### ローカル開発

```bash
# HTTPSサーバーが必要（PWA要件）
# Python 3の場合
python -m http.server 8000 --bind 127.0.0.1

# Node.jsの場合
npx http-server -p 8000 -a 127.0.0.1 --ssl
```

### 設定のカスタマイズ

#### モザイク設定
```javascript
// script.js内の設定
this.settings = {
    mosaicSize: 10,     // デフォルト粒度
    brushSize: 20,      // デフォルトブラシサイズ
    mode: 'mosaic'      // デフォルトモード
};
```

#### 履歴設定
```javascript
// HistoryManagerの最大履歴数
constructor(maxHistory = 20) {
    // ...
}
```

## 🎨 カスタマイズ例

### テーマカラーの変更
```css
/* style.css */
:root {
    --primary-color: #007aff;    /* メインカラー */
    --success-color: #34c759;    /* 成功カラー */
    --background-color: #f5f5f7; /* 背景色 */
}
```

### 対応画像形式の追加
```html
<!-- index.html -->
<input type="file" id="imageInput" accept="image/*,image/heic">
```

## 📊 パフォーマンス

### メモリ使用量
- 基本動作: ~10MB
- 4K画像処理時: ~100MB
- 履歴保持: 画像サイズ × 履歴数

### 処理速度
- モザイク描画: <100ms（通常サイズ）
- Undo/Redo: <50ms
- ファイル保存: <1秒

## 🔒 プライバシー・セキュリティ

- **完全クライアントサイド処理**: 画像データはサーバーに送信されません
- **データ保存なし**: ブラウザ終了時に全データが削除されます
- **HTTPS必須**: PWA要件によりHTTPS環境でのみ動作

## 🐛 トラブルシューティング

### よくある問題

#### 画像が読み込めない
- ファイルサイズが50MBを超えていないか確認
- 対応形式（JPEG, PNG, WebP）か確認

#### 動作が重い
- 画像サイズを小さくする
- ブラウザの他のタブを閉じる
- デバイスを再起動

#### 保存できない
- ストレージ容量を確認
- プライベートブラウジングモードでないか確認

## 📝 ライセンス

MIT License

## 🤝 貢献

プルリクエストやイシューの報告を歓迎します。

## 📞 サポート

技術的な質問や不具合報告は、GitHubのIssuesをご利用ください。 